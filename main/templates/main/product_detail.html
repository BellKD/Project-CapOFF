{% extends "base.html" %}

{% block content %}
<div class="container mt-5">

    <!-- Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ -->
    {% if messages %}
      <div class="messages position-fixed top-0 end-0 p-3" style="z-index: 1100;">
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="row">
        <!-- Ð¤Ð¾Ñ‚Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° -->
        <div class="col-md-6 text-center">
            <img src="{{ product.cover.url }}"
                  alt="{{ product.title }}"
                  style="width: 100%; max-width: 500px; height: auto; object-fit: contain;">
        </div>

        <!-- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° -->
        <div class="col-md-6 d-flex flex-column justify-content-start">
            <h2 class="fw-bold">{{ product.title }}</h2>

            {% if product.discount_price %}
                <p class="text-muted text-decoration-line-through">${{ product.price }}</p>
                <p class="fw-bold h4 text-danger">${{ product.discount_price }}</p>
            {% else %}
                <br><br>
                <p class="fw-bold h4">${{ product.price }}</p>
            {% endif %}

            <p class="mt-2">{{ product.description }}</p>

            <!-- Ð¤Ð¾Ñ€Ð¼Ð° Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ -->
            <div class="mt-4">
                <form action="{% url 'add_to_basket' product.id %}" method="post">
                    {% csrf_token %}
                    <h6 class="fw-bold mb-2">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€Ð°Ð·Ð¼ÐµÑ€:</h6>
                    <div class="btn-group" role="group" aria-label="Ð’Ñ‹Ð±Ð¾Ñ€ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð°">
                        {% for storage in product.storage_set.all %}
                            <input type="radio" class="btn-check" name="size" id="size{{ storage.size.id }}" value="{{ storage.size.id }}" autocomplete="off" {% if forloop.first %}checked{% endif %}>
                            <label class="btn btn-outline-dark" for="size{{ storage.size.id }}">{{ storage.size.title }}</label>
                        {% endfor %}
                    </div>
                    <div class="mt-3">
                        <button type="submit" class="btn btn-dark fw-bold px-4 py-2">
                            ðŸ›’ Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="container mt-5 mb-5">
  <h5 class="fw-bold mb-3">ÐŸÐ¾Ñ…Ð¾Ð¶Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹</h5>
  <div class="row row-cols-2 row-cols-md-4 g-4">
    {% for related in related_products %}
      <div class="col">
        <div class="card h-100 text-center" style="max-width: 180px; margin: auto;">
          <img src="{{ related.cover.url }}" class="card-img-top" alt="{{ related.title }}" style="height: 180px; object-fit: cover;">
          <div class="card-body">
            <h6 class="card-title">{{ related.title }}</h6>
            <p class="fw-bold">${{ related.price }}</p>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
